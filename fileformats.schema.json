{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "actions",
  "type": "object",
  "additionalProperties": false,
  "patternProperties": {
    "^[a-zA-Z0-9_/-]+$": {
      "type": "object",
      "required": [
        "name",
        "action"
      ],
      "oneOf": [
        {
          "properties": {
            "action": {
              "const": "convert"
            }
          },
          "required": [
            "convert"
          ]
        },
        {
          "properties": {
            "action": {
              "const": "extract"
            }
          },
          "required": [
            "extract"
          ]
        },
        {
          "properties": {
            "action": {
              "const": "manual"
            }
          },
          "required": [
            "manual"
          ]
        },
        {
          "properties": {
            "action": {
              "const": "rename"
            }
          },
          "required": [
            "rename"
          ]
        },
        {
          "properties": {
            "action": {
              "const": "ignore"
            }
          },
          "required": [
            "ignore"
          ]
        },
        {
          "properties": {
            "action": {
              "const": "reidentify"
            }
          },
          "required": [
            "reidentify"
          ]
        }
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "action": {
          "type": "string",
          "enum": [
            "convert",
            "extract",
            "manual",
            "rename",
            "ignore",
            "reidentify"
          ]
        },
        "convert": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "converter",
              "converter_type",
              "outputs"
            ],
            "properties": {
              "converter": {
                "type": "string"
              },
              "converter_type": {
                "type": "string",
                "enum": [
                  "master",
                  "statutory",
                  "access"
                ]
              },
              "outputs": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "minItems": 1
              }
            }
          }
        },
        "extract": {
          "type": "object",
          "required": [
            "tool",
            "extension",
            "dir_suffix"
          ],
          "properties": {
            "tool": {
              "type": "string"
            },
            "extension": {
              "type": "string"
            },
            "dir_suffix": {
              "type": "string"
            }
          }
        },
        "manual": {
          "type": "object",
          "properties": {
            "reasoning": {
              "type": "string"
            },
            "process": {
              "type": "string"
            }
          }
        },
        "rename": {
          "type": "object",
          "required": [
            "extension"
          ],
          "properties": {
            "extension": {
              "type": "string",
              "pattern": "^(\\.[^.]+)+$"
            },
            "on_extension_mismatch": {
              "type": "boolean"
            }
          }
        },
        "reidentify": {
          "type": "object",
          "required": [
            "reasoning"
          ],
          "properties": {
            "reasoning": {
              "type": "string"
            },
            "onfail": {
              "type": "string",
              "enum": [
                "convert",
                "extract",
                "manual",
                "rename",
                "ignore"
              ]
            }
          }
        },
        "ignore": {
          "type": "object",
          "properties": {
            "reasoning": {
              "type": "string"
            },
            "ignore_if": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "pixel_total": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "pixel_width": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "pixel_height": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "size": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "binary_size": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "reasoning": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}